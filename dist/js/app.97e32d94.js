(function(e){function t(t){for(var r,i,l=t[0],s=t[1],f=t[2],u=0,c=[];u<l.length;u++)i=l[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&c.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);d&&d(t);while(c.length)c.shift()();return n.push.apply(n,f||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],r=!0,l=1;l<a.length;l++){var s=a[l];0!==o[s]&&(r=!1)}r&&(n.splice(t--,1),e=i(i.s=a[0]))}return e}var r={},o={app:0},n=[];function i(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=r,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(a,r,function(t){return e[t]}.bind(null,r));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/damages/";var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var f=0;f<l.length;f++)t(l[f]);var d=s;n.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);var r=a("2b0e"),o=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"left"},[t("el-form",{attrs:{model:e.formData,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"本金"}},[t("el-input",{model:{value:e.formData.total,callback:function(t){e.$set(e.formData,"total",t)},expression:"formData.total"}})],1),t("el-form-item",{attrs:{label:"利息起算日期"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.formData.startDate,callback:function(t){e.$set(e.formData,"startDate",t)},expression:"formData.startDate"}})],1),t("el-form-item",{attrs:{label:"利息终止日期"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.formData.endDate,callback:function(t){e.$set(e.formData,"endDate",t)},expression:"formData.endDate"}})],1),t("el-form-item",{attrs:{label:"lpr倍率"}},[t("el-input",{model:{value:e.formData.rate,callback:function(t){e.$set(e.formData,"rate",t)},expression:"formData.rate"}})],1),t("el-form-item",{attrs:{label:"lpr"}},[t("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.formData.lprY,callback:function(t){e.$set(e.formData,"lprY",t)},expression:"formData.lprY"}},[t("el-option",{attrs:{label:"一年期",value:"oneY"}}),t("el-option",{attrs:{label:"五年期",value:"fiveY"}})],1)],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("计算")]),t("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出")])],1)],1)],1),t("div",{staticClass:"right"},[t("el-table",{staticStyle:{width:"100%"},attrs:{"summary-method":e.getSummaries,data:e.tableData,stripe:"","show-summary":""}},[t("el-table-column",{attrs:{prop:"total",label:"本金"}}),t("el-table-column",{attrs:{prop:"start",label:"利息起算日期"}}),t("el-table-column",{attrs:{prop:"end",label:"利息截止日期"}}),t("el-table-column",{attrs:{prop:"days",label:"计算天数"}}),t("el-table-column",{attrs:{prop:"lpr",label:"LPR（%）"}}),t("el-table-column",{attrs:{prop:"interest",label:"利息",formatter:e.intFt}})],1)],1)])},n=[],i=(a("14d9"),a("13d5"),a("25ca"));function l(e,t,a){var r=new Array,o=new Array;for(const i in e)if(e.hasOwnProperty(i)){const t=e[i];var n=new Array;for(const e in t)if(t.hasOwnProperty(e)){const a=t[e];n.push(a),o.length<d(t)&&o.push(e)}r.push(n)}a&&(o=a),r.splice(0,0,o),console.log("🚀 ~ file: excel.js:34 ~ exportExcel ~ keyArray:",o),console.log("🚀 ~ file: excel.js:34 ~ exportExcel ~ data:",r);const l=i["b"].aoa_to_sheet(r);l["!cols"]=[{wch:17},{wch:20},{wch:20},{wch:10},{wch:10},{wch:18}],l["!rows"]=Array.from({length:r.length},()=>({hpt:20}));for(let i=0;i<6;i++)l[i+"1"]={alignment:{horizontal:"center",vertical:"center"}};const s=i["b"].book_new();i["b"].book_append_sheet(s,l,"SheetJS"),i["c"](s,t+".xlsx")}function s(e){var t=document.createElement("input");t.setAttribute("id","file"),t.setAttribute("type","file"),t.setAttribute("name","file"),t.setAttribute("style","visibility:hidden"),t.setAttribute("accept",".xlsx,.xls,.csv"),t.addEventListener("change",t=>{const a=t.target.files;a&&a[0]&&f(a[0],(t,a)=>{e(t,a)})}),document.body.appendChild(t),t.value,t.click()}function f(e,t){const a=e=>Array(i["b"].decode_range(e).e.c+1).fill(0).map((e,t)=>({name:i["b"].encode_col(t),key:t})),r=new FileReader;r.onload=e=>{const r=e.target.result,o=i["a"](r,{type:"binary"}),n=o.SheetNames[0],l=o.Sheets[n],s=i["b"].sheet_to_json(l,{header:1});t(s,a(l["!ref"]))},r.readAsBinaryString(e)}function d(e){var t=0;for(var a in e)e.hasOwnProperty(a)&&t++;return t}var u={exportExcel:l,importExcel:s},c=a("5a0c"),p=a.n(c),Y={name:"App",data:function(){return{visible:!1,formData:{total:null,startDate:"",endDate:"",rate:1,lprY:"oneY",lprArr:[]},tableData:[]}},mounted(){this.lprArr=a("a6a1");var e=a("b375");p.a.extend(e);var t=a("d758");p.a.extend(t)},methods:{onSubmit(){let e=[],t=this.lprArr.filter(e=>p()(e.date).isSameOrBefore(p()(this.formData.endDate))&&p()(e.date).isSameOrAfter(p()(this.formData.startDate).subtract(30,"day")));for(let a=t.length-1;a>=0;a--){const r=t[a];let o=0,n="",i="",l="",s="";a===t.length-1?(o=this.diff(t[a-1].date,this.formData.startDate),n=this.formData.startDate,i=p()(t[a-1].date).subtract(1,"day").format("YYYY-MM-DD")):0===a?(o=this.diff(this.formData.endDate,r.date)+1,n=r.date,i=this.formData.endDate):(o=this.diff(t[a-1].date,r.date),n=r.date,i=p()(t[a-1].date).subtract(1,"day").format("YYYY-MM-DD")),l=r[this.formData.lprY],s=Number(this.formData.total)*Number(o)*Number(l)*Number(this.formData.rate)/365/100,e.push({total:this.formData.total,start:n,end:i,days:o,lpr:l,interest:s})}console.log("🚀 ~ file: App.vue:86 ~ onSubmit ~ res:",JSON.stringify(e)),this.tableData=this.mergeLPR(e)},exportExcel(){let e=[...this.tableData];if(console.log("🚀 ~ exportExcel ~ data:",e),0===e.length)return void this.$message.warning({message:"请先进行计算",duration:1500});let t=this.round(e.reduce((e,t)=>+e+ +t.interest,0)),a=e.reduce((e,t)=>+e+ +t.days,0);e.push({total:"合计",start:this.formData.startDate,end:this.formData.endDate,days:a,lpr:"/",interest:+t}),console.log("🚀 ~ file: App.vue:195 ~ exportExcel ~ data:",e);let r=["本金","利息起算日期","利息截止日期","计算天数","LPR（%）","利息"];u.exportExcel(e,"违约金计算表格"+p()().format()+".xlsx",r)},getSummaries(e){const{columns:t,data:a}=e,r=[];return t.forEach((e,t)=>{if(0===t)return void(r[t]="合计");if(1===t)return void(r[t]=this.formData.startDate);if(2===t)return void(r[t]=this.formData.endDate);if(4===t)return void(r[t]="/");const o=a.map(t=>Number(t[e.property]));o.every(e=>isNaN(e))?r[t]="N/A":r[t]=this.round(o.reduce((e,t)=>{const a=Number(t);return isNaN(a)?e:e+t},0))}),r},round(e,t=2){return(Math.round(e*(10^t))/(10^t)).toFixed(t)},diff(e,t){return p()(e).diff(t,"day")},mergeLPR(e){if(0===e.length)return e;let t=[e[0]];for(let a=1;a<e.length;a++)e[a].lpr===t[t.length-1].lpr?(t[t.length-1].end=e[a].end,t[t.length-1].days+=e[a].days,t[t.length-1].interest+=e[a].interest):t.push(e[a]);return t},intFt(e){return this.round(e.interest,3)}}},v=Y,m=(a("81fe"),a("2877")),h=Object(m["a"])(v,o,n,!1,null,null,null),b=h.exports,y=a("5c96"),D=a.n(y);a("0fae");r["default"].use(D.a),r["default"].config.productionTip=!1,new r["default"]({render:e=>e(b)}).$mount("#app")},"81fe":function(e,t,a){"use strict";a("fd58")},a6a1:function(e){e.exports=JSON.parse('[{"date":"2024-04-22","oneY":"3.45","fiveY":"3.95"},{"date":"2024-03-20","oneY":"3.45","fiveY":"3.95"},{"date":"2024-02-20","oneY":"3.45","fiveY":"3.95"},{"date":"2024-01-22","oneY":"3.45","fiveY":"4.20"},{"date":"2023-12-20","oneY":"3.45","fiveY":"4.20"},{"date":"2023-11-20","oneY":"3.45","fiveY":"4.20"},{"date":"2023-10-20","oneY":"3.45","fiveY":"4.20"},{"date":"2023-09-20","oneY":"3.45","fiveY":"4.20"},{"date":"2023-08-21","oneY":"3.45","fiveY":"4.20"},{"date":"2023-07-20","oneY":"3.55","fiveY":"4.20"},{"date":"2023-06-20","oneY":"3.55","fiveY":"4.20"},{"date":"2023-05-22","oneY":"3.65","fiveY":"4.30"},{"date":"2023-04-20","oneY":"3.65","fiveY":"4.30"},{"date":"2023-03-20","oneY":"3.65","fiveY":"4.30"},{"date":"2023-02-20","oneY":"3.65","fiveY":"4.30"},{"date":"2023-01-20","oneY":"3.65","fiveY":"4.30"},{"date":"2022-12-20","oneY":"3.65","fiveY":"4.30"},{"date":"2022-11-21","oneY":"3.65","fiveY":"4.30"},{"date":"2022-10-20","oneY":"3.65","fiveY":"4.30"},{"date":"2022-09-20","oneY":"3.65","fiveY":"4.30"},{"date":"2022-08-22","oneY":"3.65","fiveY":"4.30"},{"date":"2022-07-20","oneY":"3.70","fiveY":"4.45"},{"date":"2022-06-20","oneY":"3.70","fiveY":"4.45"},{"date":"2022-05-20","oneY":"3.70","fiveY":"4.45"},{"date":"2022-04-20","oneY":"3.70","fiveY":"4.60"},{"date":"2022-03-21","oneY":"3.70","fiveY":"4.60"},{"date":"2022-02-21","oneY":"3.70","fiveY":"4.60"},{"date":"2022-01-20","oneY":"3.70","fiveY":"4.60"},{"date":"2021-12-20","oneY":"3.80","fiveY":"4.65"},{"date":"2021-11-22","oneY":"3.85","fiveY":"4.65"},{"date":"2021-10-20","oneY":"3.85","fiveY":"4.65"},{"date":"2021-09-20","oneY":"3.85","fiveY":"4.65"},{"date":"2021-08-20","oneY":"3.85","fiveY":"4.65"},{"date":"2021-07-20","oneY":"3.85","fiveY":"4.65"},{"date":"2021-06-21","oneY":"3.85","fiveY":"4.65"},{"date":"2021-05-20","oneY":"3.85","fiveY":"4.65"},{"date":"2021-04-20","oneY":"3.85","fiveY":"4.65"},{"date":"2021-03-22","oneY":"3.85","fiveY":"4.65"},{"date":"2021-02-22","oneY":"3.85","fiveY":"4.65"},{"date":"2021-01-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-12-21","oneY":"3.85","fiveY":"4.65"},{"date":"2020-11-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-10-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-09-21","oneY":"3.85","fiveY":"4.65"},{"date":"2020-08-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-07-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-06-22","oneY":"3.85","fiveY":"4.65"},{"date":"2020-05-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-04-20","oneY":"3.85","fiveY":"4.65"},{"date":"2020-03-20","oneY":"4.05","fiveY":"4.75"},{"date":"2020-02-20","oneY":"4.05","fiveY":"4.75"},{"date":"2020-01-20","oneY":"4.15","fiveY":"4.80"},{"date":"2019-12-20","oneY":"4.15","fiveY":"4.80"},{"date":"2019-11-20","oneY":"4.15","fiveY":"4.80"},{"date":"2019-10-21","oneY":"4.20","fiveY":"4.85"},{"date":"2019-09-20","oneY":"4.20","fiveY":"4.85"},{"date":"2019-08-20","oneY":"4.25","fiveY":"4.85"}]')},fd58:function(e,t,a){}});
//# sourceMappingURL=app.97e32d94.js.map